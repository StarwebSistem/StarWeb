<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pesquisar Categoria</title>
<link rel="stylesheet" href="../css/pesquisacategoria.css" />
</head>
<body>

<header>
  <h1>Categorias</h1>
  <button id="btnAdd">+ Nova Categoria</button>
</header>

<input type="text" id="searchInput" placeholder="Pesquisar categoria..." />

<table id="tblCategorias">
  <thead>
    <tr>
      <th>Ícone</th>
      <th>Descrição</th>
    </tr>
  </thead>
  <tbody>
    <!-- Linhas serão inseridas aqui pelo JS -->
  </tbody>
</table>

<div id="lblCount">0 categoria(s)</div>

<script>
  let categorias = [
    { id: 1, descricao: "Refrigerantes" },
    { id: 2, descricao: "Sucos" },
    { id: 3, descricao: "Águas" },
    { id: 4, descricao: "Cervejas" },
    { id: 5, descricao: "Vinhos" },
    { id: 6, descricao: "Destilados" }
  ];

  const tblBody = document.querySelector("#tblCategorias tbody");
  const lblCount = document.getElementById("lblCount");
  const searchInput = document.getElementById("searchInput");
  const btnAdd = document.getElementById("btnAdd");

  function renderCategorias(list) {
    tblBody.innerHTML = "";
    list.forEach(cat => {
      const tr = document.createElement("tr");
      tr.dataset.id = cat.id;

      // Coluna do ícone
      const tdIcon = document.createElement("td");
      const imgIcon = document.createElement("img");
      imgIcon.src = `../imgcategoria/${cat.id}.png`;
      imgIcon.alt = cat.descricao;
      imgIcon.className = "cat-icon";
      // Fallback se imagem não carregar
      imgIcon.onerror = () => {
        imgIcon.src = '../imgcategoria/default.png'; // Coloque um ícone default nesta pasta
      };
      tdIcon.appendChild(imgIcon);
      tr.appendChild(tdIcon);

      // Coluna da descrição
      const tdDesc = document.createElement("td");
      tdDesc.textContent = cat.descricao;
      tr.appendChild(tdDesc);

      tr.addEventListener("click", () => {
        alert(`Abrir edição da categoria: ${cat.descricao} (ID: ${cat.id})`);
      });

      tblBody.appendChild(tr);
    });
    lblCount.textContent = `${list.length} categoria(s)`;
  }

  searchInput.addEventListener("input", () => {
    const filtro = searchInput.value.toLowerCase();
    const filtradas = categorias.filter(c => c.descricao.toLowerCase().includes(filtro));
    renderCategorias(filtradas);
  });

  btnAdd.addEventListener("click", () => {
	    window.location.href = "cadcategoria.html"; // redireciona para a tela de cadastro
	  });

  renderCategorias(categorias);
</script>
</body>
</html>
